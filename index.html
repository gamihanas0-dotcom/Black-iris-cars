<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Black Iris Cars | Car Rental Morocco</title>

    <meta name="description" content="Explore Morocco. Drive Quality. Black Iris Cars offers premium car rental services across Morocco, with a diverse fleet, easy booking, and exceptional customer support.">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="data.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2Y2MG9ZZ46"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-2Y2MG9ZZ46');
    </script>

    <style>
        /* Custom Font Poppins */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap');
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f4f7f9; 
            transition: all 0.3s ease; /* For smooth RTL transition */
        }
        /* Monochrome Theme Colors + Royal Blue Accent */
        .primary-dark { background-color: #1a1a1a; } 
        .text-primary-dark { color: #1a1a1a; } 
        .accent-blue { background-color: #4169e1; } /* Royal Blue */
        .hover\:accent-blue-dark:hover { background-color: #2b4daa; } /* Darker Royal Blue */
        .text-accent-blue { color: #4169e1; }
        
        /* Hero Section with NEW Responsive Background Image */
        #hero-section {
            background-color: #1a1a1a; /* Default solid background for mobile */
            position: relative;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            padding: 4rem 0; /* Add vertical padding for mobile */
        }

        /* Overlay for hero section */
        #hero-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* 70% dark overlay */
            z-index: 1;
        }

        #hero-content {
            position: relative;
            z-index: 2;
        }

        /* Styles for featured car cards (adjust as needed) */
        .featured-car-card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .featured-car-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        /* Responsive Navbar adjustments for RTL */
        [dir="rtl"] .md\:ltr\:space-x-8 > * + * { margin-left: 0; margin-right: 2rem; }
        [dir="rtl"] .ltr\:mr-2 { margin-right: 0; margin-left: 0.5rem; }
        [dir="rtl"] .ltr\:text-left { text-align: right; }
        [dir="rtl"] .ltr\:justify-start { justify-content: flex-end; }

        /* === NEW: Compact Select Styling === */
        .compact-select {
            font-size: 0.875rem; /* 14px */
            font-weight: 600; /* font-semibold */
            color: #1a1a1a; /* text-primary-dark */
            background-color: transparent;
            border: 1px solid #d1d5db; /* border-gray-300 */
            border-radius: 0.375rem; /* rounded-md */
            padding: 8px 12px;
            margin: 0;
            cursor: pointer;
            
            /* Adds a subtle custom arrow */
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='none' stroke='%23888' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M6 9l4 4 4-4'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.2em 1.2em;

            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            
            padding-right: 2.5rem; /* Make space for the new arrow */
        }
        
        /* Make the desktop ones borderless and cleaner */
        .hidden.md\:flex .compact-select {
             border: none;
             font-weight: 600; /* font-semibold */
             font-size: 0.875rem; /* 14px */
             padding: 4px 1.4rem 4px 0;
             background-position: right 0.1rem center;
        }

        [dir="rtl"] .hidden.md\:flex .compact-select {
            background-position: left 0.1rem center;
            padding-left: 1.4rem;
            padding-right: 0;
        }
        
        [dir="rtl"] .compact-select {
            background-position: left 0.5rem center;
            padding-left: 2.5rem;
            padding-right: 12px;
        }

        /* Target the text inside the option (for black text) */
        .compact-select option {
            color: #000000;
            font-weight: 400;
        }

        /* === Media query for desktop background image === */
        @media (min-width: 768px) {
            #hero-section {
                background-image: url('https://i.postimg.cc/ZKJ3nbqB/Download-free-moroccan-wallpaper-HD.jpg');
                height: 500px; /* Set a fixed height for desktop hero */
                padding: 0; /* Reset padding for desktop */
            }
        }

    </style>
</head>
<body class="antialiased" dir="ltr">

    <header class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <a href="index.html" class="flex items-center">
                    <img src="https://i.postimg.cc/B6LWwXNL/923d79fe-5117-4849-9761-57e1fe5a8d96.jpg" alt="Black Iris Cars Logo" class="w-10 h-10 mr-2 rounded-full border border-gray-100">
                    <span class="text-2xl font-extrabold text-primary-dark">BLACK IRIS cars</span>
                </a>

                <div class="flex items-center space-x-3 sm:space-x-4">
                    
                    <div class="hidden md:flex items-center space-x-3 border-r border-gray-200 pr-3 sm:pr-4">
                        <select id="currency-selector" class="compact-select">
                            <option value="DH">DH</option>
                            <option value="EUR">EUR</option>
                            <option value="USD">USD</option>
                        </select>
                        <select id="language-selector" class="compact-select">
                            <option value="en">EN</option>
                            <option value="fr">FR</option>
                            <option value="ar">AR</option>
                        </select>
                    </div>

                    <nav class="hidden md:flex md:ltr:space-x-8">
                        <a href="#featured" class="text-gray-600 hover:text-accent-blue transition duration-150" data-i18n="nav-fleet">Our Fleet</a>
                        <a href="#why-us" class="text-gray-600 hover:text-accent-blue transition duration-150" data-i18n="nav-why">Why Choose Us</a>
                        <a href="#contact" class="text-gray-600 hover:text-accent-blue transition duration-150" data-i18n="nav-contact">Contact</a>
                    </nav>

                    <button id="mobile-menu-button" class="md:hidden text-gray-600 hover:text-accent-blue p-2 rounded-lg transition duration-150">
                        <i data-lucide="menu" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div id="mobile-menu" class="md:hidden bg-white border-t border-gray-100 opacity-0 -translate-y-2 transform transition-all duration-300 ease-out fixed top-16 left-0 right-0 z-40" style="pointer-events: none;">
            <div class="px-4 pt-4 pb-3 space-y-4">
                <div class="flex items-center space-x-4">
                    <select id="currency-selector-mobile" class="compact-select w-full">
                        <option value="DH">DH</option>
                        <option value="EUR">EUR</option>
                        <option value="USD">USD</option>
                    </select>
                    <select id="language-selector-mobile" class="compact-select w-full">
                        <option value="en">English</option>
                        <option value="fr">Français</option>
                        <option value="ar">العربية</option>
                    </select>
                </div>
                
                <div class="space-y-1">
                    <a href="#featured" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50 hover:text-accent-blue" data-i18n="nav-fleet">Our Fleet</a>
                    <a href="#why-us" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50 hover:text-accent-blue" data-i18n="nav-why">Why Choose Us</a>
                    <a href="#contact" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50 hover:text-accent-blue" data-i18n="nav-contact">Contact</a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section id="hero-section" class="relative flex items-center justify-center text-center text-white">
            <div id="hero-content" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
                <h1 class="text-4xl sm:text-5xl md:text-6xl font-extrabold leading-tight mb-4" data-i18n="hero-h1">
                    Explore Morocco. Drive Quality.
                </h1>
                <p class="text-lg sm:text-xl font-light mb-8" data-i18n="hero-p">
                    Your journey starts with the perfect car. Rent with Black Iris Cars.
                </p>

                <div class="bg-white p-6 sm:p-8 rounded-lg shadow-xl text-primary-dark max-w-2xl mx-auto">
                    <h2 class="text-2xl font-bold mb-6 text-left" data-i18n="h2-book-car">Book Your Car</h2>
                    <form id="rental-form" class="space-y-4 sm:space-y-0 sm:grid sm:grid-cols-3 sm:gap-4">
                        <div class="relative">
                            <label for="location" class="sr-only" data-i18n="label-location">Pickup Location</label>
                            <select id="location" name="location" required
                                class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-accent-blue focus:border-accent-blue compact-select">
                                <option value="" disabled selected data-i18n="select-location">Select a location</option>
                                <option value="Casablanca">Casablanca</option>
                                <option value="Marrakech">Marrakech</option>
                                <option value="Rabat">Rabat</option>
                                <option value="Agadir">Agadir</option>
                            </select>
                            <i data-lucide="map-pin" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"></i>
                        </div>
                        <div class="relative">
                            <label for="pickup-date" class="sr-only" data-i18n="label-pickup">Pickup Date</label>
                            <input type="date" id="pickup-date" name="pickup-date" required
                                class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-accent-blue focus:border-accent-blue text-primary-dark">
                            <i data-lucide="calendar" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"></i>
                        </div>
                        <div class="relative">
                            <label for="return-date" class="sr-only" data-i18n="label-return">Return Date</label>
                            <input type="date" id="return-date" name="return-date" required
                                class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-accent-blue focus:border-accent-blue text-primary-dark">
                            <i data-lucide="calendar-check" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"></i>
                        </div>
                        <button type="submit"
                            class="sm:col-span-3 w-full accent-blue text-white font-semibold py-3 rounded-md hover:accent-blue-dark transition duration-300 shadow-lg mt-4 sm:mt-0"
                            data-i18n="btn-find-cars">
                            Find Available Cars
                        </button>
                    </form>
                </div>
            </div>
        </section>

        <section id="featured" class="py-16 md:py-20 bg-gray-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-dark mb-4" data-i18n="h2-featured">Our Featured Fleet</h2>
                <p class="text-lg text-gray-600 mb-12" data-i18n="p-featured">Quality vehicles for every journey.</p>
                
                <div id="featured-cars-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    </div>

                <div class="mt-12">
                    <a href="available_cars.html" class="inline-flex items-center accent-blue text-white font-semibold py-3 px-8 rounded-lg hover:accent-blue-dark transition duration-300 shadow-md text-lg" data-i18n="btn-view-all">
                        View All Cars <i data-lucide="arrow-right" class="w-5 h-5 ltr:ml-2"></i>
                    </a>
                </div>
            </div>
        </section>

        <section id="why-us" class="py-16 md:py-20">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-primary-dark mb-4" data-i18n="h2-why-us">Why Choose Black Iris Cars?</h2>
                <p class="text-lg text-gray-600 mb-12" data-i18n="p-why-us">Experience the difference with our commitment to excellence.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-left">
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100 flex flex-col items-center text-center">
                        <i data-lucide="car-front" class="w-12 h-12 text-accent-blue mb-4"></i>
                        <h3 class="text-xl font-bold text-primary-dark mb-3" data-i18n="why-quality-h3">Quality Fleet</h3>
                        <p class="text-gray-600" data-i18n="why-quality-p">Modern, well-maintained vehicles for safety and comfort.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100 flex flex-col items-center text-center">
                        <i data-lucide="map" class="w-12 h-12 text-accent-blue mb-4"></i>
                        <h3 class="text-xl font-bold text-primary-dark mb-3" data-i18n="why-location-h3">Convenient Locations</h3>
                        <p class="text-gray-600" data-i18n="why-location-p">Easy pickup and drop-off across major Moroccan cities.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100 flex flex-col items-center text-center">
                        <i data-lucide="award" class="w-12 h-12 text-accent-blue mb-4"></i>
                        <h3 class="text-xl font-bold text-primary-dark mb-3" data-i18n="why-service-h3">Exceptional Service</h3>
                        <p class="text-gray-600" data-i18n="why-service-p">Dedicated customer support, available 24/7 for your peace of mind.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="primary-dark text-white py-16 md:py-20">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl sm:text-4xl font-extrabold mb-4" data-i18n="h2-contact-us">Ready to Book Your Adventure?</h2>
                <p class="text-lg text-gray-300 mb-8" data-i18n="p-contact-us">Contact us today for a personalized quote or any questions you may have.</p>
                <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
                    <a href="https://wa.me/212602020402" target="_blank" class="inline-flex items-center bg-green-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-green-700 transition duration-300 shadow-md text-lg">
                        <i data-lucide="message-circle" class="w-5 h-5 ltr:mr-3"></i> <span data-i18n="btn-whatsapp">WhatsApp Now</span>
                    </a>
                    <a href="mailto:blackiriscars@gmail.com" class="inline-flex items-center bg-white text-primary-dark font-semibold py-3 px-8 rounded-lg hover:bg-gray-100 transition duration-300 shadow-md text-lg">
                        <i data-lucide="mail" class="w-5 h-5 ltr:mr-3"></i> <span data-i18n="btn-email">Email Us</span>
                    </a>
                </div>
            </div>
        </section>
    </main>

    <footer class="primary-dark text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 border-b border-gray-700 pb-8 mb-8">
                <div>
                    <h3 class="text-2xl font-extrabold mb-4 text-gray-300">BLACK IRIS cars</h3>
                    <p class="text-gray-400 text-sm">Your reliable partner for car rentals across Morocco.</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4" data-i18n="h4-nav">Quick Navigation</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#featured" class="hover:text-accent-blue transition duration-150" data-i18n="nav-fleet">Our Fleet</a></li>
                        <li><a href="#why-us" class="hover:text-accent-blue transition duration-150" data-i18n="nav-why">Our Promise</a></li>
                        <li><a href="#contact" class="hover:text-accent-blue transition duration-150" data-i18n="nav-contact">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4" data-i18n="h4-contact">Contact & Booking</h4>
                    <p class="text-sm text-gray-400 mb-2 flex items-center ltr:justify-start"><i data-lucide="phone" class="w-4 h-4 ltr:mr-2 text-accent-blue"></i> 0602020402</p>
                    <p class="text-sm text-gray-400 mb-2 flex items-center ltr:justify-start"><i data-lucide="mail" class="w-4 h-4 ltr:mr-2 text-accent-blue"></i> <a href="mailto:blackiriscars@gmail.com" class="hover:text-accent-blue">blackiriscars@gmail.com</a></p>
                    <p class="text-sm text-gray-400 mb-2 flex items-center ltr:justify-start"><i data-lucide="map-pin" class="w-4 h-4 ltr:mr-2 text-accent-blue"></i> <span data-i18n="address-text">10 rue ouarzazat hassan rabat</span></p>
                    <a href="https://wa.me/212602020402" class="text-sm text-white px-3 py-1 mt-2 inline-flex items-center rounded-lg bg-green-600 hover:bg-green-700 transition duration-150">
                        <i data-lucide="message-circle" class="w-4 h-4 ltr:mr-2"></i> <span data-i18n="whatsapp-text">WhatsApp</span> 0602020402
                    </a>
                </div>
            </div>
            <div class="text-center text-sm text-gray-500 pt-4">
                &copy; <span data-i18n="copy-right">2024 Black Iris Cars. All rights reserved.</span>
            </div>
        </div>
    </footer>

    <script>
        // --- Translations Dictionary (Data from data.js) ---
        // Translations moved to data.js for better organization.
        
        document.addEventListener('DOMContentLoaded', () => {
            // --- Global State ---
            let currentLang = localStorage.getItem('languagePreference') || 'en';
            let currentCurrency = localStorage.getItem('currencyPreference') || 'DH'; // Default currency

            // --- Element References ---
            const rentalForm = document.getElementById('rental-form');
            const locationSelect = document.getElementById('location');
            const pickupDateInput = document.getElementById('pickup-date');
            const returnDateInput = document.getElementById('return-date');
            const featuredCarsGrid = document.getElementById('featured-cars-grid');
            
            const langSelectors = document.querySelectorAll('#language-selector, #language-selector-mobile');
            const currencySelectors = document.querySelectorAll('#currency-selector, #currency-selector-mobile');

            // NEW: Seamless Mobile Menu Elements
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            // --- Core Functions ---

            function getTranslation(key) {
                const translation = translations[currentLang][key];
                return (typeof translation === 'function') ? translation : (translation || key);
            }
            
            function calculatePrice(basePrice) {
                if (currentCurrency === 'EUR') {
                    return { price: (basePrice / 10).toFixed(0), symbol: '€' };
                }
                if (currentCurrency === 'USD') {
                    return { price: (basePrice / 10).toFixed(0), symbol: '$' };
                }
                return { price: basePrice, symbol: '' }; // For DH
            }

            // Syncs desktop and mobile selectors
            function updateAllSelectors(selector, value) {
                document.querySelectorAll(selector).forEach(sel => {
                    sel.value = value;
                });
            }

            function setLanguage(lang) {
                currentLang = lang;
                updateAllSelectors('#language-selector, #language-selector-mobile', lang);
                
                const dictionary = translations[lang];
                
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    if (dictionary[key] && typeof dictionary[key] === 'string') {
                        element.textContent = dictionary[key];
                    }
                });

                document.body.setAttribute('dir', (lang === 'ar') ? 'rtl' : 'ltr');
                document.title = (getTranslation('meta-title-home') || 'Car Rental Morocco') + (lang === 'ar' ? ' | بلاك آيرس' : ' | Black Iris Cars');
                document.querySelector('meta[name="description"]').setAttribute('content', getTranslation('meta-description-home'));

                // Update text for select options that have data-i18n
                document.querySelectorAll('select option').forEach(option => {
                    const key = option.getAttribute('data-i18n');
                    if (key && dictionary[key] && typeof dictionary[key] === 'string') {
                        option.textContent = dictionary[key];
                    }
                });

                // Re-render featured cars to update language
                renderFeaturedCars();
                lucide.createIcons(); // Re-render Lucide icons for RTL if needed
            }

            function setCurrency(currency) {
                currentCurrency = currency;
                updateAllSelectors('#currency-selector, #currency-selector-mobile', currency);
                renderFeaturedCars(); // Re-render cars with new currency
            }

            function renderFeaturedCars() {
                if (!featuredCarsGrid) return; // Exit if element not found
                featuredCarsGrid.innerHTML = ''; // Clear existing cards

                // Show only the first 3 cars as featured
                carData.slice(0, 3).forEach(car => {
                    const transmissionText = getTranslation(car.transmission.toLowerCase());
                    const seatsKey = car.seats === 6 ? 'car-seats-6' : 'car-seats';
                    const seatsText = getTranslation(seatsKey);
                    const { price, symbol } = calculatePrice(car.price);
                    const carPriceString = `${symbol}${price}${currentCurrency === 'DH' ? ' DH' : ''}`;

                    const card = document.createElement('div');
                    card.className = "featured-car-card bg-white rounded-xl shadow-lg overflow-hidden";
                    card.innerHTML = `
                        <img src="${car.img}" alt="${car.name}" class="w-full h-48 object-cover">
                        <div class="p-6">
                            <h3 class="text-2xl font-bold text-gray-900 mb-2">${car.name}</h3>
                            <p class="text-gray-500 text-sm mb-4">${car.desc}</p>
                            <div class="grid grid-cols-2 gap-2 text-sm text-gray-700 mb-4">
                                <span class="flex items-center ltr:justify-start"><i data-lucide="${car.transmission === 'Automatic' ? 'car' : 'gauge'}" class="w-4 h-4 ltr:mr-2 text-primary-dark"></i> <span data-i18n="${car.transmission.toLowerCase()}">${transmissionText}</span></span>
                                <span class="flex items-center ltr:justify-start"><i data-lucide="snowflake" class="w-4 h-4 ltr:mr-2 text-primary-dark"></i> A/C</span>
                                <span class="flex items-center ltr:justify-start"><i data-lucide="users" class="w-4 h-4 ltr:mr-2 text-primary-dark"></i> <span data-i18n="${seatsKey}">${seatsText}</span></span>
                                <span class="flex items-center ltr:justify-start"><i data-lucide="paint-bucket" class="w-4 h-4 ltr:mr-2 text-primary-dark"></i> ${car.color}</span>
                            </div>
                            <div class="flex justify-between items-center border-t pt-4">
                                <span class="text-xl font-extrabold text-primary-dark">${carPriceString} <span class="text-base font-normal text-gray-500" data-i18n="car-day">/ day</span></span>
                                <a href="available_cars.html" class="accent-blue text-white font-semibold py-2 px-4 rounded-lg text-sm hover:accent-blue-dark transition duration-300" data-i18n="btn-book-now">
                                    Book Now
                                </a>
                            </div>
                        </div>
                    `;
                    featuredCarsGrid.appendChild(card);
                });
                lucide.createIcons(); // Re-render icons after adding new cards
            }

            // === NEW: Seamless Mobile Menu Logic ===
            function openMobileMenu() {
                mobileMenu.classList.remove('opacity-0', '-translate-y-2');
                mobileMenu.style.pointerEvents = 'auto';
            }

            function closeMobileMenu() {
                mobileMenu.classList.add('opacity-0', '-translate-y-2');
                mobileMenu.style.pointerEvents = 'none';
            }

            mobileMenuButton.addEventListener('click', (e) => {
                e.stopPropagation(); // Stop this click from triggering the document listener
                const isOpen = mobileMenu.classList.contains('opacity-0');
                if (isOpen) {
                    openMobileMenu();
                } else {
                    closeMobileMenu();
                }
            });

            // Close when a link is clicked
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', closeMobileMenu);
            });
            
            // Close on scroll
            window.addEventListener('scroll', closeMobileMenu);

            // Close on click outside
            document.addEventListener('click', (event) => {
                if (mobileMenu.classList.contains('opacity-0')) {
                    return; // Menu is already closed
                }
                const isClickInsideMenu = mobileMenu.contains(event.target);
                const isClickOnButton = mobileMenuButton.contains(event.target);

                if (!isClickInsideMenu && !isClickOnButton) {
                    closeMobileMenu();
                }
            });


            // --- Event Listeners ---
            rentalForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const location = locationSelect.value;
                const pickupDate = pickupDateInput.value;
                const returnDate = returnDateInput.value;

                // Save to localStorage
                localStorage.setItem('rentalLocation', location);
                localStorage.setItem('rentalPickupDate', pickupDate);
                localStorage.setItem('rentalReturnDate', returnDate);

                // Redirect to available_cars.html
                window.location.href = 'available_cars.html';
            });

            langSelectors.forEach(selector => {
                selector.addEventListener('change', (event) => {
                    setLanguage(event.target.value);
                    localStorage.setItem('languagePreference', event.target.value);
                });
            });

            currencySelectors.forEach(selector => {
                selector.addEventListener('change', (event) => {
                    setCurrency(event.target.value);
                    localStorage.setItem('currencyPreference', event.target.value);
                });
            });

            // --- Initial Setup ---
            lucide.createIcons(); // Initialize all Lucide icons

            // Set default dates for convenience (optional)
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);

            pickupDateInput.value = today.toISOString().split('T')[0];
            returnDateInput.value = tomorrow.toISOString().split('T')[0];

            // Set minimum date to today
            pickupDateInput.min = today.toISOString().split('T')[0];
            returnDateInput.min = tomorrow.toISOString().split('T')[0];

            // Update return date min when pickup date changes
            pickupDateInput.addEventListener('change', () => {
                const newPickup = new Date(pickupDateInput.value);
                const newReturnMin = new Date(newPickup);
                newReturnMin.setDate(newPickup.getDate() + 1);
                returnDateInput.min = newReturnMin.toISOString().split('T')[0];

                // If return date is before new pickup, reset it
                if (new Date(returnDateInput.value) <= newPickup) {
                    returnDateInput.value = newReturnMin.toISOString().split('T')[0];
                }
            });

            // Set initial language and currency based on localStorage or defaults
            const savedLang = localStorage.getItem('languagePreference') || 'en';
            const savedCurrency = localStorage.getItem('currencyPreference') || 'DH';
            
            updateAllSelectors('#language-selector, #language-selector-mobile', savedLang);
            updateAllSelectors('#currency-selector, #currency-selector-mobile', savedCurrency);
            
            setLanguage(savedLang); 
            setCurrency(savedCurrency); // This will also call renderFeaturedCars
        });
    </script>
</body>
</html>
